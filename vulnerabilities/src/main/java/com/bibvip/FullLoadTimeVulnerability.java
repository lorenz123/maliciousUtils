package com.bibvip;

import com.bibvip.consts.ElementType;
import lombok.extern.slf4j.Slf4j;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.interactions.Actions;

import java.util.Scanner;
import java.util.concurrent.TimeoutException;

import static com.bibvip.config.DriverConfig.driver;
import static com.bibvip.config.DriverConfig.wait;
import static com.bibvip.consts.ElementType.CSS_SELECTOR;
import static com.bibvip.consts.ElementType.X_PATH;
import static com.bibvip.utility.vulnerabilities.LoadTimeUtil.getLoadTime;
import static com.bibvip.utility.vulnerabilities.ThinkingTimeUtil.getElementWithPolling;

@Slf4j
public class FullLoadTimeVulnerability extends Vulnerability {

    public FullLoadTimeVulnerability() throws TimeoutException {
        setVulName("FullLoadTime Vulnerability");
        setErrorOfVul("FullLoadTime Vulnerability has error");

        Scanner userInput = new Scanner(System.in);
        System.out.println("What page do you want to test?");
        System.out.println("[1] Home | [2] Spot | [3] Futures (Only input the number)");

        String pageNumber = userInput.nextLine();
        String pageUrl;
        if (pageNumber.equals("1")) {
            pageUrl = ".logo";
            String homeURL = "https://www.bibvip.com/en_US";
//            WebElement click = getLoadTime(wait, pageUrl, CSS_SELECTOR);
//            click.click();

            getLoadTime(homeURL);


        } else if (pageNumber.equals("2")) {
            pageUrl = ".spot";
            String spotURL = "https://www.bibvip.com/en_US/spot/BTC_USDT";
//            WebElement click = getLoadTime(wait, pageUrl, CSS_SELECTOR);
//            click.click();

            getLoadTime(spotURL);

        } else if (pageNumber.equals("3")) {
            // Locating the Main Menu (Parent element)
            String futuresURL = "https://www.bibvip.com/en_US/futures";
//            WebElement click = getLoadTime(wait, pageUrl, CSS_SELECTOR);
//            click.click();

            getLoadTime(futuresURL);


//            pageUrl = "/html/body/div[1]/div/div/header/header/div[1]/div[2]";
//            String futuresBtn = "/html/body/div[1]/div/div/header/header/div[1]/div[2]/ul/li[1]";
//            WebElement futuresMenu = getLoadTime(wait, pageUrl, X_PATH);
//            //Instantiating Actions class
//            Actions actions = new Actions(driver);
//            //Hovering on main menu
//            actions.moveToElement(futuresMenu);
//            // Locating the element from Sub Menu
//            WebElement subMenu = getLoadTime(wait, futuresBtn, X_PATH);
//            //To mouseover on sub menu
//            actions.moveToElement(subMenu);
//            //build()- used to compile all the actions into a single step
//            actions.click().build().perform();
        } else {
            log.error("unknown page is entered!");
        }
    }

}
